<% if document.previewable? %>
  <% if document.pdf? %>
    <div class="pdf-viewer-container"
         data-controller="pdf-viewer"
         data-pdf-viewer-target="container"
         data-pdf-viewer-document-url-value="<%= rails_storage_proxy_path(document.file) %>"
         data-pdf-viewer-document-name-value="<%= document.name %>"
         data-pdf-viewer-organization-name-value="<%= Current.organization.name %>"
         data-pdf-viewer-annotations-url-value="<%= document_annotations_path(document) %>"
         data-pdf-viewer-document-id-value="<%= document.id %>"
         data-pdf-viewer-tracking-url-value="<%= update_time_tracking_document_path(document) %>"
         data-pdf-viewer-user-name-value="<%= current_user.name %>"
         data-pdf-viewer-initial-page-value="<%= params[:page].to_i if params[:page].present? %>"
         data-pdf-viewer-initial-annotation-value="<%= params[:annotation] %>">
      <div class="pdf-viewer-toolbar">
        <%= render "documents/pdf_viewer_toolbar",
            document: document,
            close_url: local_assigns[:close_url],
            can_edit: local_assigns[:can_edit],
            can_download: local_assigns[:can_download],
            compare_options: local_assigns[:compare_options] %>
      </div>
      <div class="pdf-viewer-body">
        <div class="pdf-loading-overlay" data-pdf-viewer-target="loadingOverlay">
          <div class="pdf-loading-spinner"></div>
          <div class="pdf-loading-text"><%= t('pdf_viewer.loading') %></div>
        </div>
        <div class="pdf-pages-container" data-pdf-sync-scroll-target="container" data-action="scroll->pdf-sync-scroll#sync"></div>
      </div>
    </div>
  <% elsif document.image? %>
    <div class="text-center mt-3">
      <%= image_tag rails_storage_proxy_path(document.file), alt: document.name, style: "max-width: 90%" %>
    </div>
  <% end %>
<% elsif document.file.attached? %>
  <div class="m-4 alert alert-dark text-center">
    <p><%= t('documents.show.file_not_previewable') %></p>
    <%= download_button t('documents.show.download'), rails_storage_proxy_path(document.file), class: 'btn btn-primary' %>
  </div>
<% else %>
  <div class="m-4 alert alert-dark text-center">
    <p><%= t('documents.show.file_missing') %></p>
  </div>
<% end %>
